<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fretboard Scale Visualizer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Fretboard Scale Visualizer</h1>
            <p class="subtitle">Visualize scales and modes on any stringed instrument</p>
        </header>
        
        <!-- Settings Bar - Moved to top -->
        <div class="settings-bar">
            <button class="settings-toggle" id="settings-toggle">⚙️ Settings</button>
            <div class="settings-panel" id="settings-panel" style="display: none;">
                <h3>Settings</h3>
                <div class="settings-group">
                    <label>Visual Style:</label>
                    <div class="button-group">
                        <button class="version-btn" data-version="1">Classic</button>
                        <button class="version-btn" data-version="2">Colorful</button>
                        <button class="version-btn active" data-version="3">Minimal</button>
                        <button class="version-btn" data-version="4">Bold</button>
                        <button class="version-btn" data-version="5">Square</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label>Note Shape:</label>
                    <div class="button-group">
                        <button class="shape-btn active" data-shape="square">Square</button>
                        <button class="shape-btn" data-shape="circular">Circular</button>
                        <button class="shape-btn" data-shape="dot">Dot</button>
                        <button class="shape-btn" data-shape="small-dot">Small Dot</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label>Note Names:</label>
                    <div class="button-group">
                        <button class="note-format-btn active" data-format="letter">Letters</button>
                        <button class="note-format-btn" data-format="numerical">Numbers</button>
                        <button class="note-format-btn" data-format="roman">Roman</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label>Color Palette:</label>
                    <div class="button-group">
                        <button class="palette-btn active" data-palette="default">Default</button>
                        <button class="palette-btn" data-palette="warm">Warm</button>
                        <button class="palette-btn" data-palette="cool">Cool</button>
                        <button class="palette-btn" data-palette="vibrant">Vibrant</button>
                        <button class="palette-btn" data-palette="monochrome">Monochrome</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label for="fret-count-input">Frets / Columns:</label>
                    <div class="number-input-wrapper">
                        <button class="number-input-btn" id="fret-count-decrease">−</button>
                        <input type="number" id="fret-count-input" min="5" max="30" value="20" class="settings-input">
                        <button class="number-input-btn" id="fret-count-increase">+</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label>Fretboard Mirroring:</label>
                    <div class="button-group">
                        <button class="mirror-btn" id="mirror-horizontal" data-mirror="horizontal">Horizontal</button>
                        <button class="mirror-btn" id="mirror-vertical" data-mirror="vertical">Vertical</button>
                        <button class="mirror-btn active" id="mirror-none" data-mirror="none">None</button>
                    </div>
                </div>
                <div class="settings-group" id="custom-grid-settings" style="display: none;">
                    <label for="grid-rows-input">Grid Rows:</label>
                    <div class="number-input-wrapper">
                        <button class="number-input-btn" id="grid-rows-decrease">−</button>
                        <input type="number" id="grid-rows-input" min="2" max="32" value="10" class="settings-input">
                        <button class="number-input-btn" id="grid-rows-increase">+</button>
                    </div>
                    <label for="grid-cols-input" style="margin-top: 10px;">Grid Columns:</label>
                    <div class="number-input-wrapper">
                        <button class="number-input-btn" id="grid-cols-decrease">−</button>
                        <input type="number" id="grid-cols-input" min="2" max="32" value="10" class="settings-input">
                        <button class="number-input-btn" id="grid-cols-increase">+</button>
                    </div>
                </div>
                <div class="settings-group" id="grid-interval-settings" style="display: none;">
                    <label>Grid Interval Presets:</label>
                    <div class="button-group">
                        <button class="interval-preset-btn" data-preset="4ths" data-row="5" data-col="1">4ths</button>
                        <button class="interval-preset-btn" data-preset="tritone" data-row="6" data-col="1">Tritone</button>
                        <button class="interval-preset-btn" data-preset="5ths" data-row="7" data-col="1">5ths</button>
                        <button class="interval-preset-btn" data-preset="midimech" data-row="5" data-col="2">Midimech</button>
                    </div>
                    <label for="grid-row-interval-input" style="margin-top: 10px;">Row Interval (semitones):</label>
                    <div class="number-input-wrapper">
                        <button class="number-input-btn" id="grid-row-interval-decrease">−</button>
                        <input type="number" id="grid-row-interval-input" min="1" max="12" value="1" class="settings-input">
                        <button class="number-input-btn" id="grid-row-interval-increase">+</button>
                    </div>
                    <label for="grid-col-interval-input" style="margin-top: 10px;">Column Interval (semitones):</label>
                    <div class="number-input-wrapper">
                        <button class="number-input-btn" id="grid-col-interval-decrease">−</button>
                        <input type="number" id="grid-col-interval-input" min="1" max="12" value="1" class="settings-input">
                        <button class="number-input-btn" id="grid-col-interval-increase">+</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label>Fret Number Display:</label>
                    <div class="button-group">
                        <button class="fret-display-btn active" data-display="numbers">Numbers</button>
                        <button class="fret-display-btn" data-display="pips">Pips</button>
                    </div>
                </div>
                <div class="settings-group">
                    <label for="triad-opacity-slider">Triad Line Opacity:</label>
                    <input type="range" id="triad-opacity-slider" min="0" max="100" value="60" class="settings-slider">
                    <span id="triad-opacity-value">60%</span>
                </div>
                <div class="settings-group">
                    <label>
                        <input type="checkbox" id="triad-fill-triangles"> Fill Triad Triangles
                    </label>
                </div>
                <div class="settings-group" id="tuning-selector-group" style="display: none;">
                    <label for="tuning-select">Tuning:</label>
                    <select id="tuning-select" class="settings-input">
                        <option value="">Select tuning...</option>
                    </select>
                </div>
                <div class="settings-group">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <h4 style="margin: 0;">Custom Tuning Editor</h4>
                        <button class="settings-toggle" id="toggle-tuning-editor" style="padding: 4px 10px; font-size: 0.75em;">Show</button>
                    </div>
                    <div id="tuning-editor-container" style="display: none;"></div>
                </div>
            </div>
        </div>
        
        <!-- Controls Section -->
        <div class="controls-section">
            <div class="control-group">
                <label for="instrument-select">Instrument:</label>
                <select id="instrument-select" class="control-select"></select>
            </div>
            
            <div class="control-group">
                <label for="key-select">Key:</label>
                <select id="key-select" class="control-select"></select>
            </div>
            
            <div class="control-group">
                <label for="scale-select">Scale/Mode:</label>
                <select id="scale-select" class="control-select"></select>
            </div>
        </div>
        
        <!-- Circle Visualizations -->
        <div class="circle-section">
            <div class="circle-controls">
                <button class="circle-toggle" id="toggle-circle-fifths">Circle of Fifths</button>
                <button class="circle-toggle" id="toggle-chromatic">Chromatic Circle</button>
            </div>
            <div class="circles-container">
                <div id="circle-of-fifths" class="circle-container" style="display: none;"></div>
                <div id="chromatic-circle" class="circle-container" style="display: none;"></div>
            </div>
        </div>

        <!-- Feature Toggles Bar - Right above fretboard, 5 buttons in a row -->
        <div class="feature-toggles-bar">
            <button class="feature-toggle-btn active" id="toggle-scale" data-feature="scale">Scale</button>
            <button class="feature-toggle-btn" id="toggle-chords" data-feature="chords">Chords</button>
            <button class="feature-toggle-btn" id="toggle-intervals" data-feature="intervals">Intervals</button>
            <button class="feature-toggle-btn" id="toggle-patterns" data-feature="patterns">Patterns</button>
            <button class="feature-toggle-btn" id="toggle-triads" data-feature="triads">Triads</button>
        </div>

        <!-- Fretboard Container -->
        <div class="fretboard-container">
            <div id="fretboard" class="fretboard version-3">
                <div id="fretboard-loading" style="padding: 40px; text-align: center; color: #666;">
                    Loading fretboard...
                </div>
            </div>
            <!-- SVG overlay for triad connections -->
            <svg id="triad-connections" class="triad-connections-overlay"></svg>
        </div>
        
        <!-- Legend - Below fretboard -->
        <div id="legend-container" class="legend-container-bottom"></div>
        
        <!-- Bottom Controls Bar - Chord and Triad selectors -->
        <div class="bottom-controls-bar">
            <div class="control-item-spaced">
                <label for="chord-select" class="control-label">Chord:</label>
                <select id="chord-select" class="control-select-small">
                    <option value="">None</option>
                </select>
            </div>
            <div class="control-item-spaced" id="triad-controls" style="display: none;">
                <label for="triad-select" class="control-label">Triad/Diad:</label>
                <select id="triad-select" class="control-select-small" multiple size="4" style="min-height: 80px;">
                    <option value="">None</option>
                </select>
                <label for="triad-method-select" class="control-label">Method:</label>
                <select id="triad-method-select" class="control-select-small">
                    <option value="connected">Connected</option>
                    <option value="close-voicing">Close Voicing</option>
                    <option value="spread">Spread</option>
                    <option value="string-sets">String Sets</option>
                    <option value="string-sets-2-3">2-3 Strings</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Load modules in order -->
    <script src="debug-console.js"></script>
    <script src="scales.js"></script>
    <script src="instruments.js"></script>
    <script src="visualization.js"></script>
    <script src="circle-of-fifths.js"></script>
    <script src="chords.js"></script>
    <script src="intervals.js"></script>
    <script src="patterns.js"></script>
    <script src="tuning-editor.js"></script>
    <script src="note-interactions.js"></script>
    <script src="triads.js"></script>
    <script src="legend.js"></script>
    <script src="scale-degrees.js"></script>
    <script src="fret-markers.js"></script>
    <script src="chord-library.js"></script>
    <script src="midi-support.js"></script>
    <script src="script.js"></script>
</body>
</html>
